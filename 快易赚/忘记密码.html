<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta name="format-detection" content="telephone=no,email=no,adress=no"/>
<title>首页</title>
<link rel="stylesheet" type="text/css" href="css/common.css" />
<script type="text/javascript" src="script/jquery.js"></script>
</head>
<body>
<!-- 页面头部 -->
<section>
  <div class="navigation-bar"> <a href="#" class="z-01"></a> <span>注册</span> <a href="#" class="z-02"></a> </div>
</section>
<!-- 中间内容 -->
<div class="register">
  <div class="wrapper-reg">
    <div class="page-header">
        <a href="/">
            <img src="images/findpwd.png">
        </a>
    </div>
    <div class="page-main">
<form id="registerForm" name="registerForm" method="post" action="" class="reg-form">
	   <div class="m-field">
	   	   <div class="iconphone"></div><input id="registerForm:mobileNumber" type="text" name="registerForm:mobileNumber" class="c-txt" maxlength="15" placeholder="请输入绑定手机号">
	       <p id="mobileNumberErrorDiv" class="validateNew"></p>
	   </div>
	   <div class="m-field m-yzm">
	       <div class="m-code">
	   	   <div class="iconyzm"></div><input id="registerForm:authCode" type="text" name="registerForm:authCode" class="c-txt c-code" maxlength="6" placeholder="请输入验证码">
	       
	       </div>
	       
	       <span class="c-yzm c-hqyzm">获取验证码</span>
	       <span id="sendCode" class="c-yzm c-hqyzm"><a id="registerForm:sendAuthCodeBtn" href="#" style="color: white;" class="hqyzm">发送验证码</a>
			</span>
			<span id="sendCodeGrey" style="display:none;" class="c-yzm c-hqyzming">
				<a href="javascript:void(0);" id="sendAuthCodeBtn1" class="hqyzmAfter" style="cursor:default;color: white;">免费获取校验码</a>
			</span>
	       <p id="authCodeErrorDiv" class="validateNew"></p>
	   </div>
	   <div id="inputIdCardShow" class="m-field" style="display: none;">
	   	   <div class="iconsfz"></div><input id="registerForm:idCard" type="text" name="registerForm:idCard" class="c-txt" maxlength="4" onBlur="return checkIdCard()" placeholder="请输入身份证后四位">
	       <p id="idCardErrorDiv" class="validateNew"></p>
	   </div><input id="registerForm:submitButton" type="submit" name="registerForm:submitButton" value="下一步" style="border:none;cursor:pointer;" class="btn-submit mt20" onClick="return checkAll();">
</form>
    </div>

</div>
</div>
<script type="text/javascript">
		//<![CDATA[
		var flag = false;
		//验证码发送消息提示
		function sCode(xhr, status, args) {
			if (!args.validationFailed) {
				$("#sendCode").hide();
				$("#sendCodeGrey").show();
				if(flag && $("#sendCode").is(":hidden")){
					return;
				}
				flag = true;
				timer("sendAuthCodeBtn1", {
					"count" : 60,
					"animate" : true,
					initTextBefore : "重新获取",
					initTextAfter : "秒",
					callback:function(){
						$("#sendCode").show();
						$("#sendCodeGrey").hide();
						flag = false;
					}
				}).begin();
			}
		}
		
		function checkNull()
		{
			var mobileNumber = $("#registerForm\\:mobileNumber").val();
			var nullFlag=(mobileNumber=="")||(mobileNumber=="请输入绑定手机号");
			if(nullFlag)
			{
				$("#mobileNumberErrorDiv").empty();
				$("#mobileNumberErrorDiv").append("请输入您的手机号");
			}
			else
			{
				$("#mobileNumberErrorDiv").empty();
			}
			var authCode=$("#registerForm\\:authCode").val();
			nullAuthCodeFlag=authCode==""||authCode=="请输入验证码";
			if(nullAuthCodeFlag)
			{
				$("#authCodeErrorDiv").empty();
				$("#authCodeErrorDiv").append("请输入验证码");
			}
			else
			{
				$("#authCodeErrorDiv").empty();
			}
			var allMobileFlag=null;
	   		var mobileAuth=$("#registerForm\\:mobileAuth").val();
	   		var mobileAuthFlag=mobileAuth=='已认证';
	   		if(mobileAuthFlag)
	   		{
	   			var nullIdCardFlag=(idCard=="")||(idCard=="请输入身份证后四位");
	   			if(nullIdCardFlag)
		    	{
		    		$("#idCardErrorDiv").empty();
					$("#idCardErrorDiv").append("请输入您的身份证后四位");
		    	}
		    	else
		    	{
		    		$("#idCardErrorDiv").empty();
		    	}
	   		}
		}
		
		
		function checkMobilenumber()
		{
			var mobileNumber = $("#registerForm\\:mobileNumber").val();
			var nullFlag=(mobileNumber=="")||(mobileNumber=="请输入绑定手机号");
			var mobileNumber = $("#registerForm\\:mobileNumber").val();
			var mobileRegex="^1[3|4|5|7|8][0-9]{9}$";
			var mobilePattern=new RegExp(mobileRegex);
			var mobileFlag=mobilePattern.test(mobileNumber);
			if(nullFlag)
			{
				$("#mobileNumberErrorDiv").empty();
				$("#mobileNumberErrorDiv").append("请输入您的手机号");
				return false;
			}
			else
			{
				$("#mobileNumberErrorDiv").empty();
			}
			if(!mobileFlag)
			{
				$("#mobileNumberErrorDiv").empty();
				$("#mobileNumberErrorDiv").append("请输入有效的手机号");
				return false;
			}
			else
			{
				$("#mobileNumberErrorDiv").empty();
			}
			return true;
		}
		
		
		function checkMobileAuth()
	   	{
	   		var allMobileFlag=null;
	   		var mobileAuth=$("#registerForm\\:mobileAuth").val();
	   		var mobileAuthFlag=mobileAuth=='已认证';
	   		var mobileNumber = $("#registerForm\\:mobileNumber").val();
			var nullFlag=(mobileNumber=="")||(mobileNumber=="请输入绑定手机号");
			var mobileNumber = $("#registerForm\\:mobileNumber").val();
			var mobileRegex="^1[3|4|5|7|8][0-9]{9}$";
			var mobilePattern=new RegExp(mobileRegex);
			var mobileFlag=mobilePattern.test(mobileNumber);
			if(nullFlag)
			{
				$("#mobileNumberErrorDiv").empty();
				$("#mobileNumberErrorDiv").append("请输入您的手机号");
				return false;
			}
			else
			{
				$("#mobileNumberErrorDiv").empty();
			}
			if(!mobileFlag)
			{
				$("#mobileNumberErrorDiv").empty();
				$("#mobileNumberErrorDiv").append("请输入有效的手机号");
				return false;
			}
			else
			{
				$("#mobileNumberErrorDiv").empty();
			}
	   		if(!mobileAuthFlag)
	   		{
	   			$("#mobileNumberErrorDiv").empty();
	   			$("#mobileNumberErrorDiv").append("请输入有效的手机号");
				allMobileFlag=false;
	   		}
	   		else
	   		{
	   			$("#mobileNumberErrorDiv").empty();
	   			allMobileFlag=true;
	   		}
	   		inputIdCardShow();
	   		return allMobileFlag;
	   	}
		
		function checkAuthCode()
		{
			var authCode=$("#registerForm\\:authCode").val();
			nullAuthCodeFlag=authCode==""||authCode=="请输入验证码";
			var authCodeFlag=(authCode.length==4);
			if(nullAuthCodeFlag)
			{
				$("#authCodeErrorDiv").empty();
				$("#authCodeErrorDiv").append("请输入验证码");
				return false;
			}
			else
			{
				$("#authCodeErrorDiv").empty();
			}
			if(!authCodeFlag)
			{
				$("#authCodeErrorDiv").empty();
				$("#authCodeErrorDiv").append("请输入验证码");
				return false;
			}
			else
			{
				$("#authCodeErrorDiv").empty();
			}
			return true;
		}
		
		function checkIdCard()
	    {
	    	var idCard=$("#registerForm\\:idCard").val();
	    	var nullIdCardFlag=(idCard=="")||(idCard=="请输入身份证后四位");
	    	var idCardFlag=(idCard.length==4);
	    	if(nullIdCardFlag)
	    	{
	    		$("#idCardErrorDiv").empty();
				$("#idCardErrorDiv").append("请输入您的身份证后四位");
				return false;
	    	}
	    	else
	    	{
	    		$("#idCardErrorDiv").empty();
	    	}
	    	if(!idCardFlag)
	    	{
	    		$("#idCardErrorDiv").empty();
				$("#idCardErrorDiv").append("请输入您的身份证后四位");
				return false;
	    	}
	    	else
	    	{
	    		$("#idCardErrorDiv").empty();
	    	}
			return true;
	    }
		
		function inputIdCardShow()
	    {
	    	var realNameAuth=$("#registerForm\\:realNameAuth").val();
   			var realNameAuthFlag=(realNameAuth=='已认证');
   			if(realNameAuthFlag)
   			{
   				$("#inputIdCardShow").css('display','block');
   			}
   			else
   			{
   				$("#inputIdCardShow").css('display','none');
   			}
	    }
		
		
		//验证所有信息
		function checkAll(){
			checkNull();
			var mobileFlag=checkMobileAuth();
			var realNameAuth=$("#registerForm\\:realNameAuth").val();
   			var realNameAuthFlag=(realNameAuth=='已认证');
   			var idCardFlag=true;
   			if(realNameAuthFlag)
   			{
   				idCardFlag=checkIdCard();
   			}
   			var allFlag=mobileFlag&&idCardFlag;
	    	return allFlag;
		}
		//]]>
		</script>
		<script type="text/javascript"> 
    //<![CDATA[
               
     inputIdCardShow();          
     var mobile = "";
     var authCode="";
     var idCard="";
	 if(mobile=="")
	 {
	     $("#registerForm\\:mobileNumber").val("请输入绑定手机号");
	 }
	 else
     {
		 $("#registerForm\\:mobileNumber").css("color","#4a4a4a");
     }
	 if(authCode=="")
	 {
		 $("#registerForm\\:authCode").val("请输入验证码");
	 }
	 else
	 {
		 $("#registerForm\\:authCode").css("color","#4a4a4a");
	 }
	 if(idCard=="")
	 {
		$("#registerForm\\:idCard").val("请输入身份证后四位");
	 }
	 else
     {
		 $("#registerForm\\:idCard").css("color","#4a4a4a");
     }
	     $("#registerForm\\:authCode").focusin(function(){
		 	if($("#registerForm\\:authCode").val() == "请输入验证码") {
		 		$("#registerForm\\:authCode").val("");
		 		$("#registerForm\\:authCode").css("color","#4a4a4a");
		 	}
		 }).focusout(function(){
		 	if($("#registerForm\\:authCode").val() == "" ||$("#registerForm\\:authCode").val() == "请输入验证码") {
		 		$("#registerForm\\:authCode").val("请输入验证码").css("color", "#A6A6A6");
		 	}else{
		 		$("#registerForm\\:authCode").css("color","#4a4a4a");
		 	}
		 });
		 $("#registerForm\\:mobileNumber").focusin(function(){
		 	if($("#registerForm\\:mobileNumber").val() == "请输入绑定手机号") {
		 		$("#registerForm\\:mobileNumber").val("");
		 		$("#registerForm\\:mobileNumber").css("color","#4a4a4a");
		 	}
		 }).focusout(function(){
		 	if($("#registerForm\\:mobileNumber").val() == "" ||$("#registerForm\\:mobileNumber").val() == "请输入绑定手机号") {
		 		$("#registerForm\\:mobileNumber").val("请输入绑定手机号").css("color", "#A6A6A6");
		 	}else{
		 		$("#registerForm\\:mobileNumber").css("color","#4a4a4a");
		 	}
		 });
		 
		 $("#registerForm\\:idCard").focusin(function(){
			 	if($("#registerForm\\:idCard").val() == "请输入身份证后四位") {
			 		$("#registerForm\\:idCard").val("");
			 		$("#registerForm\\:idCard").css("color","#4a4a4a");
			 	}
			 }).focusout(function(){
			 	if($("#registerForm\\:idCard").val() == "" ||$("#registerForm\\:authCode").val() == "请输入身份证后四位") {
			 		$("#registerForm\\:idCard").val("请输入身份证后四位").css("color", "#A6A6A6");
			 	}else{
			 		$("#registerForm\\:idCard").css("color","#4a4a4a");
			 	}
			 });
		 var second = 0;
	     var internal;
		 function checkSendCode()
		 {
				$("#mobileNumberErrorDiv").empty();
				var mobileNumber = $("#registerForm\\:mobileNumber").val();
				var mobileRegex="^1[3|4|5|7|8][0-9]{9}$";
				var usernamePattern=new RegExp(mobileRegex);
				var usernameFlag=usernamePattern.test(mobileNumber);
				if(!usernameFlag){
					$("#mobileNumberErrorDiv").append("请输入真实手机号码");
					return false;
				}
				var returnResult = false;
				$.ajax({
					   url: "/valiSms",
					   async:false,
					   data:{
							mobileNumber:mobileNumber
					   },
					   success: function(data){
						   if(data.flag == 'NO'){
							   $("#mobileNumberErrorDiv").html("点击过于频繁,请<b>"+data.second+"</b>秒后重试");
							   second = data.second;
							   clearInterval(internal);
							   internal = setInterval(function(){
	                              if(second == 0){
	                            	  $("#mobileNumberErrorDiv").html('');
	                              }else{
	                            	  second = second -1;
	                            	  $("#mobileNumberErrorDiv").find('b').html(second);
	                              }
							   },1000);
							   returnResult = false;
						   }else if(data.flag == 'NO1'){
							   $("#mobileNumberErrorDiv").html(data.smsVali);
							   returnResult = false;
						   }else{
							   returnResult = true;
						   }
					   }
				    });
				
				return returnResult;
		}
			
	     $(document).ready(function(){
               $("#javax_faces_developmentstage_messages").remove();
               
		     }); 
		//]]>
	</script>
<script type="text/javascript" src="script/jsf.js.htm"></script>

</body>
</html>
